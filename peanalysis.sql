-- phpMyAdmin SQL Dump
-- version 4.6.6deb5
-- https://www.phpmyadmin.net/
--
-- Host: localhost
-- Generation Time: Oct 19, 2020 at 11:57 AM
-- Server version: 5.7.30-0ubuntu0.18.04.1
-- PHP Version: 7.2.24-0ubuntu0.18.04.6

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `peanalysis`
--

-- --------------------------------------------------------

--
-- Table structure for table `behavioural`
--

CREATE TABLE `behavioural` (
  `id` int(10) UNSIGNED NOT NULL,
  `md5` binary(16) DEFAULT NULL,
  `file_exists` int(11) NOT NULL,
  `memory_processCreated` int(11) NOT NULL,
  `memory_processTerminated` int(11) NOT NULL,
  `disk_numberRecords` int(11) NOT NULL,
  `disk_fileWrite` int(11) NOT NULL,
  `disk_fileDelete` int(11) NOT NULL,
  `disk_registrySetValueKey` int(11) NOT NULL,
  `disk_registryDeleteValueKey` int(11) NOT NULL,
  `disk_registryHKLM` int(11) NOT NULL,
  `disk_registryHKCU` int(11) NOT NULL,
  `disk_registryHKCR` int(11) NOT NULL,
  `disk_registryHKU` int(11) NOT NULL,
  `disk_registryHKLM_SAM` int(11) NOT NULL,
  `disk_registryHKLM_SECURITY` int(11) NOT NULL,
  `disk_registryHKLM_SYSTEM` int(11) NOT NULL,
  `disk_registryHKLM_SOFTWARE` int(11) NOT NULL,
  `disk_fileNamePresent` int(11) NOT NULL,
  `malware_memory_processCreated` int(11) NOT NULL,
  `malware_memory_processTerminated` int(11) NOT NULL,
  `malware_disk_fileWrite` int(11) NOT NULL,
  `malware_disk_fileDelete` int(11) NOT NULL,
  `malware_disk_registrySetValueKey` int(11) NOT NULL,
  `malware_disk_registryDeleteValueKey` int(11) NOT NULL,
  `malware_disk_registryHKLM` int(11) NOT NULL,
  `malware_disk_registryHKCU` int(11) NOT NULL,
  `malware_disk_registryHKCR` int(11) NOT NULL,
  `malware_disk_registryHKU` int(11) NOT NULL,
  `malware_disk_registryHKLM_SAM` int(11) NOT NULL,
  `malware_disk_registryHKLM_SECURITY` int(11) NOT NULL,
  `malware_disk_registryHKLM_SYSTEM` int(11) NOT NULL,
  `malware_disk_registryHKLM_SOFTWARE` int(11) NOT NULL,
  `network_fileSize` int(11) NOT NULL,
  `network_numPackets` int(11) NOT NULL,
  `network_dataSize` int(11) NOT NULL,
  `network_dataRate` int(11) NOT NULL,
  `network_avgPacketSize` int(11) NOT NULL,
  `network_avgPacketRate` int(11) NOT NULL,
  `network_uniqueProtocols` int(11) NOT NULL,
  `network_uniquePacketSizes` int(11) NOT NULL,
  `network_uniqueIPs` int(11) NOT NULL,
  `network_udp` int(11) NOT NULL,
  `network_tcp` int(11) NOT NULL,
  `network_icmp` int(11) NOT NULL,
  `network_http` int(11) NOT NULL,
  `network_httpGET` int(11) NOT NULL,
  `network_httpGETexe` int(11) NOT NULL,
  `network_httpGETtxt` int(11) NOT NULL,
  `network_httpGETphp` int(11) NOT NULL,
  `network_httpGETjpg` int(11) NOT NULL,
  `category` varchar(32) NOT NULL,
  `class` varchar(128) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `data`
--

CREATE TABLE `data` (
  `id` int(10) UNSIGNED NOT NULL,
  `md5` binary(16) NOT NULL,
  `vt_codesize` bigint(20) NOT NULL,
  `vt_res_langs` bigint(20) NOT NULL,
  `vt_res_types` bigint(20) NOT NULL,
  `vt_sections` bigint(20) NOT NULL,
  `vt_entry_point` bigint(20) NOT NULL,
  `vt_initDataSize` bigint(20) NOT NULL,
  `vt_productName` bigint(20) NOT NULL,
  `vt_originalFileName` bigint(20) NOT NULL,
  `vt_unitializedDataSize` bigint(20) NOT NULL,
  `vt_legalCopyright` bigint(20) NOT NULL,
  `pe_api` bigint(20) NOT NULL,
  `pe_debug` bigint(20) NOT NULL,
  `pe_packer` bigint(20) NOT NULL,
  `pe_library` bigint(20) NOT NULL,
  `pe_autogen` bigint(20) NOT NULL,
  `pe_object` bigint(20) NOT NULL,
  `pe_executable` bigint(20) NOT NULL,
  `pe_text` bigint(20) NOT NULL,
  `pe_binary` bigint(20) NOT NULL,
  `pe_temporary` bigint(20) NOT NULL,
  `pe_database` bigint(20) NOT NULL,
  `pe_log` bigint(20) NOT NULL,
  `pe_webpage` bigint(20) NOT NULL,
  `pe_backup` bigint(20) NOT NULL,
  `pe_cabinet` bigint(20) NOT NULL,
  `pe_data` bigint(20) NOT NULL,
  `pe_registry` bigint(20) NOT NULL,
  `pe_directories` bigint(20) NOT NULL,
  `pe_dll` bigint(20) NOT NULL,
  `pe_detected` bigint(20) NOT NULL,
  `size_TEXT` bigint(20) NOT NULL,
  `size_DATA` bigint(20) NOT NULL,
  `size_OBJ` bigint(20) NOT NULL,
  `size_TOT` bigint(20) NOT NULL,
  `filesize` bigint(20) NOT NULL,
  `entropy` double NOT NULL,
  `type` text NOT NULL,
  `family` text NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `pe_header_compile_time`
--

CREATE TABLE `pe_header_compile_time` (
  `id` int(10) UNSIGNED NOT NULL,
  `md5` binary(16) NOT NULL,
  `CompileTime` datetime DEFAULT NULL,
  `malware` smallint(6) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `rawData`
--

CREATE TABLE `rawData` (
  `id` int(11) NOT NULL,
  `md5` binary(16) NOT NULL,
  `virustotal_file_report` mediumtext CHARACTER SET utf8,
  `virustotal_file_behaviour` mediumtext CHARACTER SET utf8,
  `virustotal_file_network_traffic` mediumtext CHARACTER SET utf8,
  `peframe` mediumtext CHARACTER SET utf8,
  `file` text CHARACTER SET utf8,
  `strings` mediumtext CHARACTER SET utf8,
  `size` text CHARACTER SET utf8,
  `file_entropy` double UNSIGNED DEFAULT NULL,
  `size_of_file` int(10) UNSIGNED NOT NULL,
  `do_not_process` tinyint(1) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `behavioural`
--
ALTER TABLE `behavioural`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `md5_2` (`md5`,`category`,`class`),
  ADD KEY `md5` (`md5`,`class`),
  ADD KEY `category` (`category`),
  ADD KEY `class` (`class`),
  ADD KEY `disk_numberRecords` (`disk_numberRecords`),
  ADD KEY `network_fileSize` (`network_fileSize`);

--
-- Indexes for table `data`
--
ALTER TABLE `data`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `md5` (`md5`),
  ADD KEY `pe_dll` (`pe_dll`);
ALTER TABLE `data` ADD FULLTEXT KEY `family` (`family`);
ALTER TABLE `data` ADD FULLTEXT KEY `type` (`type`);

--
-- Indexes for table `pe_header_compile_time`
--
ALTER TABLE `pe_header_compile_time`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `md5` (`md5`),
  ADD KEY `malware` (`malware`);

--
-- Indexes for table `rawData`
--
ALTER TABLE `rawData`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `md5` (`md5`),
  ADD KEY `file_entropy` (`file_entropy`),
  ADD KEY `size_of_file` (`size_of_file`),
  ADD KEY `do_not_process` (`do_not_process`);
ALTER TABLE `rawData` ADD FULLTEXT KEY `peframe` (`peframe`);
ALTER TABLE `rawData` ADD FULLTEXT KEY `virustotal_file_report` (`virustotal_file_report`);
ALTER TABLE `rawData` ADD FULLTEXT KEY `virustotal_file_behaviour` (`virustotal_file_behaviour`);
ALTER TABLE `rawData` ADD FULLTEXT KEY `virustotal_file_network_traffic` (`virustotal_file_network_traffic`);
ALTER TABLE `rawData` ADD FULLTEXT KEY `file` (`file`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `behavioural`
--
ALTER TABLE `behavioural`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10071;
--
-- AUTO_INCREMENT for table `data`
--
ALTER TABLE `data`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=328338;
--
-- AUTO_INCREMENT for table `pe_header_compile_time`
--
ALTER TABLE `pe_header_compile_time`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=545398;
--
-- AUTO_INCREMENT for table `rawData`
--
ALTER TABLE `rawData`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=407741;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
